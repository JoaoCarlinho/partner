# Organization and RBAC Endpoints
paths:
  /organizations:
    get:
      tags:
        - Organizations
      summary: List organizations
      description: Get all organizations (admin only)
      operationId: listOrganizations
      parameters:
        - name: type
          in: query
          schema:
            type: string
            enum: [creditor, legal_aid, platform]
        - name: search
          in: query
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Organizations retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        name:
                          type: string
                        type:
                          type: string
                        memberCount:
                          type: integer
                        createdAt:
                          type: string
                          format: date-time
                  meta:
                    $ref: '#/components/schemas/Pagination'

    post:
      tags:
        - Organizations
      summary: Create organization
      description: Create a new organization (admin only)
      operationId: createOrganization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - type
              properties:
                name:
                  type: string
                type:
                  type: string
                  enum: [creditor, legal_aid, platform]
                description:
                  type: string
                website:
                  type: string
                  format: uri
                address:
                  type: object
                  properties:
                    street:
                      type: string
                    city:
                      type: string
                    state:
                      type: string
                    zipCode:
                      type: string
                    country:
                      type: string
                settings:
                  type: object
      responses:
        '201':
          description: Organization created
        '403':
          $ref: '#/components/responses/ForbiddenError'

  /organizations/{organizationId}:
    get:
      tags:
        - Organizations
      summary: Get organization
      description: Get organization details
      operationId: getOrganization
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Organization retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      name:
                        type: string
                      type:
                        type: string
                      description:
                        type: string
                      website:
                        type: string
                      address:
                        type: object
                      settings:
                        type: object
                      members:
                        type: array
                        items:
                          $ref: '#/components/schemas/User'
        '404':
          $ref: '#/components/responses/NotFoundError'

    patch:
      tags:
        - Organizations
      summary: Update organization
      description: Update organization details
      operationId: updateOrganization
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                website:
                  type: string
                address:
                  type: object
                settings:
                  type: object
      responses:
        '200':
          description: Organization updated

    delete:
      tags:
        - Organizations
      summary: Delete organization
      description: Delete an organization (admin only)
      operationId: deleteOrganization
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Organization deleted
        '403':
          $ref: '#/components/responses/ForbiddenError'

  /organizations/{organizationId}/members:
    get:
      tags:
        - Organizations
      summary: List organization members
      description: Get all members of an organization
      operationId: listOrganizationMembers
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
      responses:
        '200':
          description: Members retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  meta:
                    $ref: '#/components/schemas/Pagination'

    post:
      tags:
        - Organizations
      summary: Add member
      description: Add a user to an organization
      operationId: addOrganizationMember
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  format: uuid
                role:
                  type: string
                  enum: [member, admin, owner]
      responses:
        '201':
          description: Member added

  /organizations/{organizationId}/members/{userId}:
    delete:
      tags:
        - Organizations
      summary: Remove member
      description: Remove a user from an organization
      operationId: removeOrganizationMember
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Member removed

  /roles:
    get:
      tags:
        - Organizations
      summary: List roles
      description: Get all available roles
      operationId: listRoles
      responses:
        '200':
          description: Roles retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        name:
                          type: string
                        description:
                          type: string
                        permissions:
                          type: array
                          items:
                            type: string

    post:
      tags:
        - Organizations
      summary: Create role
      description: Create a new role (admin only)
      operationId: createRole
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - permissions
              properties:
                name:
                  type: string
                description:
                  type: string
                permissions:
                  type: array
                  items:
                    type: string
      responses:
        '201':
          description: Role created

  /permissions:
    get:
      tags:
        - Organizations
      summary: List permissions
      description: Get all available permissions
      operationId: listPermissions
      responses:
        '200':
          description: Permissions retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        name:
                          type: string
                        description:
                          type: string
                        category:
                          type: string
